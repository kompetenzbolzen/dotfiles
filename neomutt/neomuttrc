# https://blog.flaport.net/configuring-neomutt-for-email.html
set folder = ~/.local/share/email
set mbox_type = Maildir

set mailcap_path = $DOTFILEBASE/neomutt/mailcap
auto_view text/html

macro index S "<shell-escape>mbsync -a<enter>" "sync email"

set use_envelope_from
set sendmail = "msmtp"

source `find $DOTFILE_SYNCDIR/mailaccounts.d/*.conf -type f -not -name .gitignore | xargs`

set sort = threads
set sort_aux = last-date-received

set date_format = "%d.%m.%Y %H:%M"

set ask_cc = yes
set ask_followup_to = yes

#
# Shortcuts
#

# j,k in pager unbinden, ich mag nicht durch mails scrollen
unbind pager j
unbind pager k
unbind index,pager Cu
unbind index,pager Cd

bind pager j next-line
bind pager k previous-line

bind index,pager \Ck sidebar-prev
bind index,pager \Cj sidebar-next
bind index,pager \Cl sidebar-open
macro index \Ch "<enter-command> toggle sidebar_new_mail_only<enter>"

bind index,pager \Cd next-page
bind index,pager \Cu previous-page

bind index G group-chat-reply

#
# Sidebar
#
unmailboxes *
mailboxes `find ~/.local/share/email \
	-mindepth 2 -type d -not -name 'new' -not -name 'cur' -not -name 'tmp' \
	-exec realpath --relative-to ~/.local/share/email {} + \
	| sed -e "s/^\(.*\)$/-label \1 +\1/" \
	| xargs`

#set sidebar_component_depth = 8
#set sidebar_folder_indent
set sidebar_visible = yes
set sidebar_short_path
set sidebar_sort_method=alpha
#set sidebar_format = '%D%<F? [%F]>%* %<N?%N/>%S'
set sidebar_format = "%D %* [%?N?%N / ?%S]"
set sidebar_divider_char = '|'
set sidebar_delim_chars = './'
# Sidebar show only new mail by default
set sidebar_new_mail_only = yes
set mail_check_stats

source style
